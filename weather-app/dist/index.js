(()=>{"use strict";function t(t,e,i,a){const s=document.createElement(t);return Array.isArray(e)?e.forEach((t=>s.classList.add(t))):t&&s.classList.add(e),i&&(s.innerText=i),a&&s.setAttribute("id",a),s}const e=new class{constructor(t){this.root=document.querySelector(t),this.bgImgDispatch={Clouds:"clouds.jpg",Clear:"clear.jpg",Drizzle:"drizzle.jpg",Mist:"mist.jpg",Snow:"snow.jpg",Thunder:"thunder.jpg"}}createCard({type:e,city:i,degree:a}){const s=t("div","card"),n=t("div","type",e),r=t("div","city",i),c=t("div","degree",a);s.appendChild(r);const h=t("div","other"),o=t("div","degree-container");return o.appendChild(c),[o,n].forEach((t=>h.appendChild(t))),s.appendChild(h),s}insertCard=t=>{const e=this.createCard(t);this.root.innerHTML="",this.root.appendChild(e)};changeBackground(t){t in this.bgImgDispatch&&(document.querySelector("html").style.backgroundImage=`linear-gradient(to top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.30)), url(images/${this.bgImgDispatch[t]})`)}shakeInput(){const t=document.getElementById("search-city-input");t.classList.add("shaking"),setTimeout((()=>t.classList.remove("shaking")),500)}}("#root"),i=new class{constructor(t,e){this.view=t,this.inputElement=document.querySelector(e),this.API_KEY="0e53e87f32b3455f4c4a3fec3c04c53b",this.initialStateDone=!1}async submitCity(t){if(t===this.lastCity)return;const e=await this.fetchData(t),i={city:e.name,type:e.weather[0].main,degree:e.main.temp};this.lastCity=i.city,this.view.changeBackground(i.type),this.view.insertCard(i)}async fetchData(t){const e=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${t}&APPID=${this.API_KEY}&units=metric`);if(!e.ok)throw this.view.shakeInput(),new Error(`Problem in fetch in ${t}`);return e.json()}initialState(t="Ankara"){this.initialStateDone||(this.submitCity(t),this.lastCity=t,this.initialStateDone=!0)}async doSearch(){this.submitCity(this.inputElement.value)}}(e,"#search-city-input");document.getElementById("search-city-form").addEventListener("submit",(t=>{t.preventDefault(),i.doSearch()})),i.initialState()})();